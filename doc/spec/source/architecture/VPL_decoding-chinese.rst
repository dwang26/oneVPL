.. SPDX-FileCopyrightText: 2019-2020 Intel Corporation
..
.. SPDX-License-Identifier: CC-BY-4.0

=================
视频解码（DECODE）
=================

:term:`DECODE` 类函数将压缩比特流作为输入，并将其转换为原始帧作为输出。

DECODE 仅处理纯视频流或基本视频流，但 AV1/VP9/VP8 解码器除外，它们接受 IVF 格式。该库可以处理驻留在 IVF 容器中的比特流，但不能处理驻留在任何其他容器格式（如 MP4 或 MPEG）中的比特流。

应用程序必须首先对比特流进行解复用。解复用会从容器格式中提取纯视频流。应用程序可以将输入比特流作为一个完整的数据帧、部分帧（少于一个完整帧）或多个帧。如果仅提供部分帧，DECODE 会在解码之前在内部构建一个数据帧。

比特流缓冲区的时间戳必须精确到帧数据的第一个字节。对于 H.264，帧数据的第一个字节来自视频编码层中的 NAL 单元。对于 MPEG-2 或 VC-1，帧数据的第一个字节来自图片头。DECODE 将时间戳传递到输出表面以进行音频和视频复用或同步。

解码第一帧是一种特殊情况，因为 DECODE 没有提供足够的配置参数来正确处理比特流。DECODE 搜索序列头（H.264 中的序列参数集或 MPEG-2 和 VC-1 中的序列头），其中包含用于编码后续视频帧的视频配置参数。解码器会跳过序列头之前的任何比特流。如果比特流中有多个序列头，DECODE 会采用新的配置参数，确保正确解码后续帧。

DECODE 支持在解码期间随时重新定位比特流。
由于在位置更改后无法获得与指定比特流位置相关联的正确序列头，因此应用程序必须向 DECODE 提供序列头，然后解码器才能在新位置处理下一帧。如果应用程序未提供在新位置正确解码比特流所需的序列头，DECODE 会将新位置视为新的“第一帧”，并遵循第一帧解码的流程。